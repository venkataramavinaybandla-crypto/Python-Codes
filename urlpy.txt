from urllib.parse import urlparse
import re
import ipaddress

SUSPICIOUS_WORDS = (
    "login signin update secure bank confirm verify account authorize "
    "click free voucher reward prize install payment"
).split()


def normalize_url(url):
    if not re.match(r'^[a-zA-Z]+://', url):
        url = 'http://' + url
    return url


def get_hostname(url):
    url = normalize_url(url)
    parsed = urlparse(url)
    return parsed.hostname or ""


def is_ip(hostname):
    if not hostname:
        return False
    try:
        ipaddress.ip_address(hostname)
        return True
    except Exception:
        return False


def simple_score(url):
    reasons = []
    score = 0
    u = normalize_url(url)
    host = get_hostname(u)
    low = u.lower()

    if len(u) > 75:
        score += 1
        reasons.append("very long URL")

    if is_ip(host):
        score += 2
        reasons.append("uses raw IP address")

    for w in SUSPICIOUS_WORDS:
        if w in low:
            score += 1
            reasons.append(f"contains suspicious word '{w}'")
            break

    if "@" in u:
        score += 2
        reasons.append("contains '@' (possible credential trick)")

    if host.count('.') >= 4:
        score += 1
        reasons.append("many subdomains")

    if '-' in host:
        score += 1
        reasons.append("hyphen in domain")

    if host.endswith(('.xyz', '.top', '.club', '.online', '.site', '.pw', '.info')):
        score += 1
        reasons.append("uses commonly abused TLD")

    return score, reasons


def decide(score, threshold=3):
    return "Harmful" if score >= threshold else "Likely safe"


if __name__ == "__main__":
    print(" URL threat Detector \n")
    url = input("Enter a URL to check: ").strip()

    score, reasons = simple_score(url)
    print("\n--- Result ---")
    print(f"URL: {url}")
    print(f"Score: {score}")
    print(f"Decision: {decide(score)}")
    print("\nReasons:")
    for r in reasons:
        print(f"- {r}")
